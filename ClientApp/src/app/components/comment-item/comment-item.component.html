<div class="comment-thread">
  <div class="comment-item-card">
    <div class="user-avatar">{{ comment.userName[0].toUpperCase() }}</div>
    
    <div class="comment-content">
      <div class="comment-meta">
        <span class="username">{{ comment.userName }}</span>
        <span class="timestamp">{{ comment.createdAt | date:'dd.MM.yyyy HH:mm' }}</span>
      </div>
      
      <div class="comment-body" [innerHTML]="comment.text"></div>

      @if (comment.imageUrl || comment.textFileUrl) {
        <div class="comment-attachments">
          @if (comment.imageUrl) {
            <div class="attachment-image">
              <a [href]="comment.imageUrl" target="_blank">
                <img [src]="comment.imageUrl" alt="–ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
              </a>
            </div>
          }
          @if (comment.textFileUrl) {
            <div class="attachment-file">
              <a [href]="comment.textFileUrl" target="_blank" class="file-link">
                <i class="icon">üìÑ</i> –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
              </a>
            </div>
          }
        </div>
      }

      <div class="comment-footer">
        <button (click)="toggleReply()" class="reply-trigger" [class.active]="isReplying">
          {{ isReplying ? '–û—Ç–º–µ–Ω–∞' : '–û—Ç–≤–µ—Ç–∏—Ç—å' }}
        </button>
      </div>
    </div>
  </div>

  @if (isReplying) {
    <div class="inline-reply-form">
      <app-comment-form [parentId]="comment.id" (commentCreated)="onReplyCreated()"></app-comment-form>
    </div>
  }

  @if (comment.replies && comment.replies.length > 0) {
    <div class="nested-replies">
      @for (reply of comment.replies; track reply.id) {
        <app-comment-item [comment]="reply" (commentCreated)="commentCreated.emit()"></app-comment-item>
      }
    </div>
  }
</div>